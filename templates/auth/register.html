{% extends './base.html' %}

{% block title %}Register{% endblock %}


{% block body %}
<form id="register-form" class="formulario">
    <h1>Crea tu cuenta en HORRORPEDIA
    </h1>
    <div class="contenedor">
        <div class="input-contenedor">
            <i class="fa-solid fa-user icon"></i>
            <input type="text" id="userName" name="userName" placeholder="Usuario">
        </div>
        <div class="input-contenedor">
            <i class="fa-solid fa-envelope icon"></i>
            <input type="text" id="email" name="email" placeholder="Correo">
        </div>
        <div class="input-contenedor">
            <i class="fa-solid fa-lock icon"></i>
            <input type="password" id="password" name="password" placeholder="Contraseña">
        </div>
        <input type="submit" value="Registrarse" class="button">
        <p>¿Ya te registraste?<a class="link" href="/login">Iniciar sesión</a></p>
    </div>
</form>
{% endblock %}


{% block customJS %}
<script>
    var formulario = document.getElementById('register-form');
    var userName = document.getElementById('userName');
    var email = document.getElementById('email');
    var password = document.getElementById('password');

    formulario.onsubmit = (e) => {
        e.preventDefault();
        fetch('/register', {
            method: 'POST',
            body: JSON.stringify({
                'userName': userName.value,
                'email': email.value,
                'password': password.value
            }),
            headers: {
                'Content-Type': 'application/json'
            }
        }).then(res => res.json()).then(data => {
            if (data.status === "success") {
                window.location.href = '/login';
            } else {
                alert(data.message);
            }
        });
    }
</script>
{% endblock %}