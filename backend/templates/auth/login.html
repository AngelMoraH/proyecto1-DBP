{% extends './base.html' %}

{% block title %}Login{% endblock %}


{% block body %}

<form id="login-form" class="formulario">
    <h1>Inicia Sesion</h1>
    <div class="contenedor">
        <div class="input-contenedor">
            <i class="fa-solid fa-user icon"></i>
            <input type="text" id="email" name="email" placeholder="Correo electronico">
        </div>
        <div class="input-contenedor">
            <i class="fa-solid fa-lock icon"></i>
            <input type="password" id="password" name="password" placeholder="Contraseña">
        </div>
        <input type="submit" value="Iniciar sesión" class="button">
        <p>¿No tienes una cuenta?<a class="link" href="/register">Regístrate</a></p>
    </div>
</form>
{% endblock %}

{% block customJS %}
<script>
    var formulario = document.getElementById('login-form');
    var email = document.getElementById('email');
    var password = document.getElementById('password');

    formulario.onsubmit = (e) => {
        e.preventDefault();
        if (email.value == '' && password.value == '') {
            alert('Por favor, rellene los campos email y contraseña');
        } else if (email.value == '') {
            alert('Por favor, rellene el campo email');
        } else if (password.value == '') {
            alert('Por favor, rellene el campo contraseña');
        } else {
            fetch('/login/', {
                method: 'POST',
                body: JSON.stringify({
                    'email': email.value,
                    'password': password.value
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.status === "success") {
                        window.location.href = '/';
                    } else {
                        alert(data.message);
                    }
                });
        }
    }

</script>
{% endblock %}